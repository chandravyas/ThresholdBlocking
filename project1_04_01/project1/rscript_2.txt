library(readr)
library(distances)
library(plyr)
library(scclust)
library(factoextra)
testinput <- read_csv("fields_mod.csv",col_names = FALSE)
datamatrix <- as.matrix(testinput)
my_dist <- distances(datamatrix)
my_clustering <- sc_clustering(my_dist, 10)
outvalue <- cbind(datamatrix,my_clustering)
aggdata<- aggregate(cbind(X1,X2,X3,X4,X5) ~ my_clustering,FUN = mean, data=testinput)
dbscan::kNNdistplot(aggdata[,1:5], k =  3)
abline(h = 75, lty = 2)
set.seed(123)
res.fpc <- fpc::dbscan(aggdata[,1:5], eps = 75, MinPts = 3)
res.fpc$cluster
fviz_cluster(res.fpc, aggdata[,-1], geom = "point")
dbscan.out<-cbind(res.fpc$cluster,aggdata)
dt1 <- data.frame(outvalue)
dt2 <- data.frame(dbscan.out[,1:2])
dt3 <-join(dt1,dt2,type="inner")
 
 
 
library(readr)
library(distances)
library(plyr)
library(scclust)
library(factoextra)
testinput <- read_csv("fields_mod.csv",col_names = FALSE)
datamatrix <- testinput[sample(1:nrow(testinput), 20000,replace=FALSE),]
datamatrix <- as.matrix(datamatrix) 
res.fpc <- fpc::dbscan(datamatrix, eps = 30, MinPts = 30)