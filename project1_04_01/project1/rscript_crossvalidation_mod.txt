


library(readr)
library(distances)
library(plyr)
library(scclust)
library(caret)
testinput <- read_csv("fields_mod.csv",col_names = FALSE)

testinputnew <- testinput[sample(1:nrow(testinput), 25000,replace=FALSE),]

for(i in 1:4) {

percenatage<- (1-i*0.1)

smp_size<- floor(percenatage * nrow(testinputnew))
set.seed(123)
inTrain <- sample(seq_len(nrow(testinputnew)),size=smp_size)

training <- testinputnew[inTrain,]
testing <- testinputnew[-inTrain,]

datamatrix <- as.matrix(training)
my_dist <- distances(datamatrix)

my_clustering <- sc_clustering(my_dist, 50)
outvalue <- cbind(datamatrix,my_clustering)
aggdata<- aggregate(cbind(X1,X2,X3,X4,X5) ~ my_clustering,FUN = mean, data=training)
fit <- kmeans(aggdata[,2:6], 13, iter.max=5, nstart=10)
clust.out <- as.factor(fit$cluster)
kclust <- as.matrix(clust.out)
kclust.out <- cbind(kclust, aggdata)
dt1 <- data.frame(outvalue)
dt2 <- data.frame(kclust.out[,1:2])
dt3 <-join(dt1,dt2,type="inner")
dt4<-subset(dt3, select=c("kclust"))
dt5<-subset(dt3, select=-c(my_clustering))

modFit <- train(kclust~.,subset(dt3, select=-c(my_clustering)),method="rpart")
testing$clusters <- predict(modFit,testing)

x<-as.integer(unlist(dt4, use.names = FALSE)) 
training$clusters<-as.factor(x)
cls.scatt <- cls.scatt.data(training[,1:5], x,dist="euclidean")
#print("Intra and Inter cluster distances are")
#print(cls.scatt)


#not sure below

joineddata<-rbind(training,testing)
joineddataclusters<- as.integer(joineddata$clusters)
cls.scatt1 <- cls.scatt.data(joineddata[,1:5], joineddataclusters,dist="euclidean")
#print("Intra and Inter cluster distances are")
#print(cls.scatt1)




print(rowMeans(cls.scatt1$intracls.average)-rowMeans(cls.scatt$intracls.average))

}

10fold,20fold,30fold,40fold
17.93667,21.64965,15.89886,-11.50824
There were 15 warnings (use warnings() to see them)

> cls.scatt1$intracls.average
           c1       c2       c3       c4       c5       c6      c7       c8       c9      c10      c11      c12      c13
[1,] 30.84326 42.17594 46.50428 53.40957 36.26823 41.90274 182.836 112.3816 100.6453 51.65266 36.07045 46.38492 102.9497
> cls.scatt$intracls.average
           c1       c2       c3       c4       c5       c6       c7       c8       c9      c10      c11      c12      c13
[1,] 30.84326 42.17594 46.50428 53.40957 36.26823 41.90274 68.11957 112.3816 462.3072 51.65266 36.07045 46.38492 31.77691

> cls.scatt$intercls.average
            c1         c2         c3         c4         c5         c6       c7       c8        c9       c10        c11
c1     0.00000  137.45164  137.80127  152.21828   68.46177   98.25542 316.3291 552.9285 1151.1985 212.98278   65.69114
c2   137.45164    0.00000  252.03821  282.79504   78.84677  182.24023 186.6616 422.6354 1020.7008  87.46977  190.65316
c3   137.80127  252.03821    0.00000   84.73162  188.12714   86.07888 432.1224 669.3269 1267.5684 326.92726   84.48689
c4   152.21828  282.79504   84.73162    0.00000  212.91223  140.45198 463.8697 700.9508 1299.4458 359.15686   99.64743
c5    68.46177   78.84677  188.12714  212.91223    0.00000  127.31537 254.7540 491.4137 1089.7374 152.05949  121.62508
c6    98.25542  182.24023   86.07888  140.45198  127.31537    0.00000 358.7294 594.9522 1192.4574 254.56503   76.11253
c7   316.32909  186.66164  432.12235  463.86974  254.75400  358.72941   0.0000 243.6495  839.0856 115.99283  371.70888
c8   552.92850  422.63543  669.32690  700.95081  491.41369  594.95216 243.6495   0.0000  603.8213 347.76582  609.06282
c9  1151.19854 1020.70075 1267.56839 1299.44581 1089.73737 1192.45737 839.0856 603.8213    0.0000 944.98467 1207.71653
c10  212.98278   87.46977  326.92726  359.15686  152.05949  254.56503 115.9928 347.7658  944.9847   0.00000  266.99531
c11   65.69114  190.65316   84.48689   99.64743  121.62508   76.11253 371.7089 609.0628 1207.7165 266.99531    0.00000
c12  109.32189   93.19611  184.15534  229.82159   77.00784  109.61975 257.5039 492.0945 1088.9515 156.46036  141.26939
c13   55.04210  129.20846  127.73118  164.27553   70.12662   67.19122 308.8716 546.2704 1144.8014 204.13974   74.79555
           c12        c13
c1   109.32189   55.04210
c2    93.19611  129.20846
c3   184.15534  127.73118
c4   229.82159  164.27553
c5    77.00784   70.12662
c6   109.61975   67.19122
c7   257.50393  308.87156
c8   492.09449  546.27037
c9  1088.95149 1144.80141
c10  156.46036  204.13974
c11  141.26939   74.79555
c12    0.00000   74.99256
c13   74.99256    0.00000
> cls.scatt1$intercls.average
           c1        c2        c3        c4        c5        c6       c7       c8        c9       c10       c11       c12
c1    0.00000 137.45164 137.80127 152.21828  68.46177  98.25542 143.8234 552.9285  75.69233 212.98278  65.69114 109.32189
c2  137.45164   0.00000 252.03821 282.79504  78.84677 182.24023 204.8436 422.6354 156.60177  87.46977 190.65316  93.19611
c3  137.80127 252.03821   0.00000  84.73162 188.12714  86.07888 160.0600 669.3269 159.23727 326.92726  84.48689 184.15534
c4  152.21828 282.79504  84.73162   0.00000 212.91223 140.45198 182.5337 700.9508 188.77601 359.15686  99.64743 229.82159
c5   68.46177  78.84677 188.12714 212.91223   0.00000 127.31537 169.4969 491.4137  97.65261 152.05949 121.62508  77.00784
c6   98.25542 182.24023  86.07888 140.45198 127.31537   0.00000 143.6510 594.9522 105.67916 254.56503  76.11253 109.61975
c7  143.82339 204.84360 160.06002 182.53373 169.49694 143.65102   0.0000 539.1250 168.60133 246.67506 129.77672 177.97950
c8  552.92850 422.63543 669.32690 700.95081 491.41369 594.95216 539.1250   0.0000 551.43287 347.76582 609.06282 492.09449
c9   75.69233 156.60177 159.23727 188.77601  97.65261 105.67916 168.6013 551.4329   0.00000 227.53157 101.14625 114.11900
c10 212.98278  87.46977 326.92726 359.15686 152.05949 254.56503 246.6751 347.7658 227.53157   0.00000 266.99531 156.46036
c11  65.69114 190.65316  84.48689  99.64743 121.62508  76.11253 129.7767 609.0628 101.14625 266.99531   0.00000 141.26939
c12 109.32189  93.19611 184.15534 229.82159  77.00784 109.61975 177.9795 492.0945 114.11900 156.46036 141.26939   0.00000
c13  96.23357 113.08572 186.10112 220.14900  83.93243 122.17771 174.6778 493.1387 113.01460 169.25705 129.79068  93.16344
          c13
c1   96.23357
c2  113.08572
c3  186.10112
c4  220.14900
c5   83.93243
c6  122.17771
c7  174.67781
c8  493.13868
c9  113.01460
c10 169.25705
c11 129.79068
c12  93.16344
c13   0.00000
> 